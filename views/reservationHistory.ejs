<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>History-ATV Rental</title>
    <link rel="stylesheet" href="userdashboard.css">
    <link rel="icon" href="LOGOATV.png" type="image/x-icon">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Aclonica&family=Baloo+Tamma+2&family=Black+Ops+One&family=Bungee+Inline&family=Fredericka+the+Great&family=Fredoka&family=Rubik+Moonrocks&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@48,400,0,0" />
    <style>
      .ScheduleTable{
        position: relative;
        width: 100%;
        height: 10vh;
        background-color: rgb(30, 30, 30);
        margin-top: 10px;
        padding-top: 10px;
        border: 2px solid rgb(161, 161, 161);
        text-align: center;
        margin: 0;
       
    }
    .ScheduleTable .thead{
        margin: 0;
    }
    .ScheduleTable th{
        background-color: rgb(105, 105, 105);
        height: 30px;
        color: white;
        margin: 0;
        border-right: 2px solid rgb(95, 95, 95); 
    }
    .ScheduleTable tr{
        border-bottom: 1px solid rgb(97, 97, 97); 
        margin: 0;
        height: auto;
    }
    .tbody{
        height: 0vh;
        
    }
    .ScheduleTable td{
        border-bottom: 2px solid rgb(168, 168, 168); 
        border-right: 2px solid rgb(168, 168, 168); 
        margin: 0;
        width: auto;
        height: auto;
    }
    .ScheduleTable span{
        color: rgb(255, 255, 255);
        cursor: pointer;
        font-weight: bold;
    }
    .ScheduleTable span:hover{
        color: rgb(255, 208, 0);
    }
    .mainbody{
      width: 100%;

    }
    .myreservations{
      border-radius: 10px;
    }

  </style>
  </head>
<body>
    <div class="sidebar">
        <div class="topsidebar">
            <img src="ATVLOGO.png" class="logo">
        </div>
        <div class="close" id="close_btn" onclick="toggleSidebar()">
            <a href="#">
            <span class="material-symbols-outlined" >cancel</span>
            </a>
        </div>
        <div class="menubar" id="menu_btn">
            <a href="#">
                <span class="material-symbols-rounded">menu</span>
            </a>

        </div>
        <div class="menu">
            <a href="userDashboard" >
                <span class="material-symbols-outlined">dashboard</span>
                <h3>Dashboard</h3>
            </a>
            <a href="MakeAreservation">
                <span class="material-symbols-outlined">book_online</span>
                <h3>Make a Reservation</h3>
            </a>
                
            <a href="reservationHistory"style="background-color: rgb(68, 68, 68);">
                <span class="material-symbols-outlined"style="color: yellow;">history</span>
                <h3 style="color: yellow;">Reservation History</h3>
            </a>
            <a href="takenNoteUser">
                <span class="material-symbols-outlined">description</span>
                <h3>Takenote</h3>
            </a>
            <a href="rulesAndRegulation">
                <span class="material-symbols-outlined">rule</span>
                <h3>Rules and Regulation</h3>
            </a>
            <a href="/logout">
                <span class="material-symbols-outlined">logout</span>
                <h3>Logout</h3>
              </a>
        </div>
        <div class="date-time-container">
            <div class="time" id="time"></div>
            <div class="date" id="date"></div>
          </div>
    </div>
    <div class="mainbody">

        <div class="myreservations" style="margin-top: 40px; margin-bottom: 20px;">
          <div class="tophis" style="display: flex;">
            <h2 style="width: 85%;">My Reservations</h2>
            <h3 style="width: 15%; color:white;">
              <% if (custReservationsI.reservDate instanceof Date) { %>
                <%= custReservationsI.reservDate.toISOString().split('T')[0] %>
              <% } else if (custReservationsI.reservDate) { %>
                <%= (new Date(custReservationsI.reservDate)).toISOString().split('T')[0] %>
              <% } else { %>
                No Date Available
              <% } %>
              </h3>
          </div>
            
            <div class="reservationdetail">
                  <table class="ScheduleTable"  >
                    <thead class="thead">
                      <tr>
                        <th>Name of Tour</th>
                        <th>Tour Price</th>
                        <th>Duration</th>
                        <th>Total of Individual</th>
                        <th>Time Slot</th>
                        <th>Balance</th>
                        <th>InitialPayment</th>
                        <th>TotalPayment</th>
                        <th>Status</th>

                      </tr>
                    </thead>
                    <tbody>
                  
                            <tr>
                              <td><%= custReservationsI.tourName %></td>
                              <td><%= custReservationsI.tourPrice %></td>
                              <td><%= custReservationsI.duration %></td>
                              <td><%= custReservationsI.totalPerson %></td>
                              <td><%= custReservationsI.timeSlot %></td>
                              <td><%= custReservationsI.Balance %></td>
                              <td><%= custReservationsI.InitialPayment %></td>
                              <td><%= custReservationsI.TotalPayment %></td>
                              <td><%= custReservationsI.status %></td>
                             
                            </tr>
                 
                    </tbody>
                  </table >
                  
                </tbody>
              </table>
            </div>
          </div>

          <div class="myreservations" style="margin-top: 10px; margin-bottom: 50px;">
            <div class="tophis" style="display: flex;">
              <h2 style="width: 85%;">Pax Info</h2>
              <h3 style="width: 15%; color:white;">
                <% if (custReservationsI.reservDate instanceof Date) { %>
                  <%= custReservationsI.reservDate.toISOString().split('T')[0] %>
                <% } else if (custReservationsI.reservDate) { %>
                  <%= (new Date(custReservationsI.reservDate)).toISOString().split('T')[0] %>
                <% } else { %>
                  No Date Available
                <% } %>
                </h3>
            </div>
              
              <div class="reservationdetail">
                    <table class="ScheduleTable"  >
                      <thead class="thead">
                        <tr>
                          <th>Pax Name</th>
                          <th>Age</th>
                          <th>Contact No.</th>
                          <th>Gmail</th>
                        </tr>
                      </thead>
                      <tbody>
                    
                        <% if (custReservationsI.PaxInfo && Array.isArray(custReservationsI.PaxInfo) && custReservationsI.PaxInfo.length > 0) { %>
                          <% custReservationsI.PaxInfo.forEach(function(pax) { %>
                              <tr>
                                  <td><%= pax.PaxFname %> <%= pax.PaxMname %> <%= pax.PaxSname %></td>
                                  <td><%= pax.PaxAge %></td>
                                  <td><%= pax.PaxPhoneNo %></td>
                                  <td><%= pax.PaxEmail %></td>
                              </tr>
                          <% }); %>
                      <% } else { %>
                          <tr>
                              <td colspan="4">No Pax Information Available</td>
                          </tr>
                      <% } %>
                   
                      </tbody>
                    </table >
                    
                  </tbody>
                </table>
              </div>
            </div>

    </div>
    
    
  </div>
  <script>
    function togglePasswordVisibility() {
      const passwordField = document.getElementById('password');
      const eyeIcon = document.getElementById('eye');
      const eyeOffIcon = document.getElementById('eye-off');
      
      if (passwordField.type === 'password') {
        passwordField.type = 'text';
        eyeIcon.style.display = 'block';
        eyeOffIcon.style.display = 'none';
      } else {
        passwordField.type = 'password';
        eyeIcon.style.display = 'none';
        eyeOffIcon.style.display = 'block';
      }
    }
</script>
  <script>
    async function deleteReservation(reservationId) {
        try {
            const response = await fetch(`/deleteReservation/${reservationId}`, {
                method: 'DELETE'
            });

            if (response.ok) {
                // Delete was successful, remove the reservation row
                const reservationRow = document.getElementById(`reservationRow_${reservationId}`);
                if (reservationRow) {
                    reservationRow.remove();
                }
            } else {
                console.error('Failed to delete reservation');
            }
        } catch (error) {
            console.error('Error:', error);
        }
    }
</script>










  <script>
    // Get the word follower element
const wordFollower = document.createElement('div');
wordFollower.id = 'word-follower';
wordFollower.textContent = 'Click to Download';
document.body.appendChild(wordFollower);

// Function to show the word follower and position it at the cursor
function showWordFollower(event) {
wordFollower.style.display = 'block';
wordFollower.style.left = event.clientX + 'px';
wordFollower.style.top = event.clientY + 'px';
}

// Function to hide the word follower
function hideWordFollower() {
wordFollower.style.display = 'none';
}
</script>
<script>
function downloadATVLogo() {
const atvLogoImage = document.querySelector(".atvLogo");
const atvLogoDataURL = atvLogoImage.src;

const downloadATVLogoLink = document.getElementById("downloadATVLogoLink");
downloadATVLogoLink.href = atvLogoDataURL;
}

</script>
    <script>
        function updateDateTime() {
    const dateElement = document.getElementById('date');
    const timeElement = document.getElementById('time');

    const currentDate = new Date();

    const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
    const dateString = currentDate.toLocaleDateString(undefined, options);

    const timeString = currentDate.toLocaleTimeString();

    dateElement.textContent = dateString;
    timeElement.textContent = timeString;
}
    setInterval(updateDateTime, 1000);
    updateDateTime();

    </script>
    <script>

      function toggleEdit1() {
            var editME= document.getElementById("editME");
            if (editME.style.display === "none") {
              editME.style.display = "block";
            } else {
              editME.style.display = "none";
            }
          }
      
      </script>
  <script>
              // Get the word follower element
const wordFollower = document.createElement('div');
wordFollower.id = 'word-follower';
wordFollower.textContent = 'Edit me!';
document.body.appendChild(wordFollower);

// Function to show the word follower and position it at the cursor
function showWordFollower(event) {
  wordFollower.style.display = 'block';
  wordFollower.style.left = event.clientX + 'px';
  wordFollower.style.top = event.clientY + 'px';
}

// Function to hide the word follower
function hideWordFollower() {
  wordFollower.style.display = 'none';
}
  </script>
  <script>
      document.addEventListener("DOMContentLoaded", function() {
    const input = document.getElementById("picture");
    const img = document.getElementById("uploadedImage");
    const img2 = document.getElementById("picturekopo");

    input.addEventListener("change", function(event) {
      const file = event.target.files[0];
      const reader = new FileReader();

      reader.onload = function() {
        img.src = reader.result;
        img2.src = reader.result;
      };

      if (file) {
        reader.readAsDataURL(file);
      }
    });
  });

</script>
<script>
function saveProfile() {
const name = document.getElementById("name").value;
const cellphone = document.getElementById("cellphone").value;
const gmail = document.getElementById("gmail").value;
const address = document.getElementById("address").value;
const username = document.getElementById("username").value;

document.querySelector(".Name").innerText = name;




// Here you can update other parts of the profile as well if needed, such as the image or other details.

// Toggle back to the original view after saving
toggleEdit();
}

function toggleEdit() {
// Code to toggle between the profile view and the edit view (your existing implementation)
}

</script>
</body>
<script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
</html>